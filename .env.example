# PantryPal Environment Configuration Example
# Copy this file to .env and fill in your values

# ===================================
# Database (PostgreSQL)
# ===================================
DB_PASSWORD=pantrypal_secure_password_change_me

# ===================================
# MinIO Object Storage
# ===================================
MINIO_ROOT_USER=pantrypal_admin
MINIO_ROOT_PASSWORD=change_this_minio_password_to_something_secure
MINIO_SECURE=false  # Set to true when using HTTPS

# Bucket Names (default values, usually no need to change)
MINIO_BUCKET_PRODUCTS=pantrypal-products
MINIO_BUCKET_USERS=pantrypal-users
MINIO_BUCKET_RECEIPTS=pantrypal-receipts
MINIO_BUCKET_RECIPES=pantrypal-recipes

# ===================================
# Security
# ===================================
# Generate a secure random key: openssl rand -hex 32
SECRET_KEY=change-this-to-a-random-secret-key-minimum-32-characters-long

# ===================================
# Recipe Integration
# ===================================
ENABLE_RECIPE_INTEGRATION=true

# ===================================
# Email/SMTP Configuration
# ===================================
# Required for password reset functionality
# Use Gmail App Password (not your regular password)
# Guide: https://support.google.com/accounts/answer/185833

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-gmail-app-password
SMTP_FROM_EMAIL=your-email@gmail.com
SMTP_FROM_NAME=PantryPal
SMTP_USE_TLS=true

# ===================================
# Other SMTP Providers (Examples)
# ===================================

# Outlook/Office365:
# SMTP_HOST=smtp-mail.outlook.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@outlook.com
# SMTP_PASSWORD=your-password

# Yahoo:
# SMTP_HOST=smtp.mail.yahoo.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@yahoo.com
# SMTP_PASSWORD=your-app-password

# Custom SMTP Server:
# SMTP_HOST=mail.yourdomain.com
# SMTP_PORT=587
# SMTP_USERNAME=your-username
# SMTP_PASSWORD=your-password

# ===================================
# Application URL Configuration
# ===================================
# Base URL for email links (password reset, email verification)
# IMPORTANT: Must match exactly how users access your service (including port!)
#
# Common configurations:
#   Production with domain:     APP_URL=https://pantrypal.palstack.io
#   Production with IP:         APP_URL=http://192.168.1.100:8080
#   Local development (Vite):   APP_URL=http://localhost:5173
#   Local docker (nginx):       APP_URL=http://localhost:8888
#
# Port guide:
#   - nginx in docker-compose exposes on port 8888 by default (see ports: "8888:80")
#   - If you change the exposed port to 8080, use that port in APP_URL
#   - If using reverse proxy (Caddy/Nginx) on standard ports, omit the port
#
# If not set, will use the incoming request URL (unreliable for emails)

APP_URL=http://localhost:8888

# ===================================
# OIDC/OAuth Authentication (Optional)
# ===================================
# Enable single sign-on with OpenID Connect providers
# Supports: Google, Microsoft Azure AD, Keycloak, Authentik, and any OIDC-compliant provider
# Disabled by default - traditional username/password auth will be used

# Enable OIDC authentication
OIDC_ENABLED=false

# Provider display name (shown on login button)
OIDC_PROVIDER_NAME=Google

# OAuth Client Credentials (from your provider)
OIDC_CLIENT_ID=your-client-id.apps.googleusercontent.com
OIDC_CLIENT_SECRET=your-client-secret

# OIDC Discovery URL (automatic configuration)
# For Google: https://accounts.google.com/.well-known/openid-configuration
# For Microsoft: https://login.microsoftonline.com/{tenant-id}/v2.0/.well-known/openid-configuration
# For Keycloak: https://your-keycloak.com/realms/{realm}/.well-known/openid-configuration
OIDC_DISCOVERY_URL=https://accounts.google.com/.well-known/openid-configuration

# OAuth Callback URL (must match your provider configuration)
# Should be: {APP_URL}/api/auth/oidc/callback
OIDC_REDIRECT_URI=http://localhost:3000/api/auth/oidc/callback

# OAuth Scopes (space-separated)
# Default: openid profile email
OIDC_SCOPES=openid profile email

# Auto-link existing users by email
# If true, OIDC login will automatically link to existing accounts with matching email
# If false, users must manually link their accounts
OIDC_AUTO_LINK=true

# Auto-create new users from OIDC
# If true, new users can self-register via OIDC
# If false, users must be manually created by admin before OIDC login
OIDC_AUTO_CREATE=true

# ===================================
# Manual OIDC Configuration (Advanced)
# ===================================
# Only needed if your provider doesn't support OIDC Discovery
# If OIDC_DISCOVERY_URL is set, these are ignored

# OIDC_AUTHORIZATION_ENDPOINT=https://accounts.google.com/o/oauth2/v2/auth
# OIDC_TOKEN_ENDPOINT=https://oauth2.googleapis.com/token
# OIDC_USERINFO_ENDPOINT=https://openidconnect.googleapis.com/v1/userinfo

# ===================================
# Provider-Specific Setup Guides
# ===================================

# Google OAuth Setup:
# 1. Go to https://console.cloud.google.com/apis/credentials
# 2. Create OAuth 2.0 Client ID
# 3. Add authorized redirect URI: {APP_URL}/api/auth/oidc/callback
# 4. Copy Client ID and Secret
# OIDC_PROVIDER_NAME=Google
# OIDC_CLIENT_ID=your-id.apps.googleusercontent.com
# OIDC_CLIENT_SECRET=your-secret
# OIDC_DISCOVERY_URL=https://accounts.google.com/.well-known/openid-configuration

# Microsoft Azure AD Setup:
# 1. Go to https://portal.azure.com
# 2. Register application in Azure AD
# 3. Add redirect URI: {APP_URL}/api/auth/oidc/callback
# 4. Create client secret in "Certificates & secrets"
# OIDC_PROVIDER_NAME=Microsoft
# OIDC_CLIENT_ID=your-application-id
# OIDC_CLIENT_SECRET=your-client-secret
# OIDC_DISCOVERY_URL=https://login.microsoftonline.com/{tenant-id}/v2.0/.well-known/openid-configuration

# Keycloak Setup:
# 1. Create client in your realm
# 2. Set Access Type to "confidential"
# 3. Add valid redirect URI: {APP_URL}/api/auth/oidc/callback
# 4. Get client secret from "Credentials" tab
# OIDC_PROVIDER_NAME=Keycloak
# OIDC_CLIENT_ID=pantrypal
# OIDC_CLIENT_SECRET=your-client-secret
# OIDC_DISCOVERY_URL=https://your-keycloak.com/realms/{realm}/.well-known/openid-configuration
